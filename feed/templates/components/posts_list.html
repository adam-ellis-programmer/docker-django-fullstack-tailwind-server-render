<!-- Mixed Posts and Advertisements List Template -->
{% for item in items %} {% if item.type == 'advertisement' %}
<!-- Advertisement -->
{% include 'components/advertisement.html' with ad=item %} {% else %}
<!-- Regular Post -->
<article
  class="bg-white rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 overflow-hidden"
>
  <!-- Post Header -->
  <div class="p-4 flex items-center space-x-3">
    <img
      src="{{ item.author.avatar }}"
      alt="{{ item.author }}"
      class="w-12 h-12 rounded-full object-cover border-2 border-gray-100"
    />
    <div class="flex-1">
      <h3 class="font-semibold text-gray-900">{{ item.author }}</h3>
      <div class="flex items-center space-x-2 text-sm text-gray-500">
        <span>{{ item.username }}</span>
        <span>|</span>
        <span>{{ item.created_at|timesince }} ago</span>
        {% if item.location %}
        <span>|</span>
        <span class="flex items-center">
          <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
              clip-rule="evenodd"
            ></path>
          </svg>
          {{ item.location }}
        </span>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Post Title -->
  {% if item.title %}
  <div class="px-4 pb-3">
    <h2 class="text-xl font-bold text-gray-900">{{ item.title }}</h2>
  </div>
  {% endif %}

  <!-- Post Image -->
  <div class="relative">
    <img
      src="{{ item.image }}"
      alt="{{ item.title }}"
      class="w-full h-80 object-cover"
    />
    <div
      class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"
    ></div>
  </div>

  <!-- Post Content -->
  <div class="p-4">
    <div class="text-gray-800 leading-relaxed mb-4">
      {{ item.text|linebreaks }}
    </div>

    <!-- Tags -->
    {% if item.tags %}
    <div class="flex flex-wrap gap-2 mb-4">
      {% for tag in item.tags %}
      <span
        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"
      >
        #{{ tag }}
      </span>
      {% endfor %}
    </div>
    {% endif %}

    <!-- Engagement Stats -->

    <div
      class="flex items-center justify-between pt-4 border-t border-gray-100"
    >
      <div class="flex items-center space-x-6">
        <!-- Likes -->

        <!-- Debug version - Use display: none instead of hidden class -->

        <!-- Template: Only render one heart at a time -->
        <button
          class="like-button flex items-center space-x-1 transition-colors {% if item.user_has_liked %}text-red-500{% else %}text-gray-500 hover:text-red-500{% endif %}"
          data-post-id="{{ item.id }}"
        >
          <!-- Only show one heart based on like status -->
          {% if item.user_has_liked %}
          <i class="fa-solid fa-heart text-red-500"></i>
          {% else %}
          <i class="fa-regular fa-heart"></i>
          {% endif %}

          <span class="like-count text-sm font-medium">{{ item.likes }}</span>
        </button>

        <!-- Comments -->
        <button
          class="flex items-center space-x-1 text-gray-500 hover:text-blue-500 transition-colors"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.418 8-9.877 8A8.977 8.977 0 013 12V5a2 2 0 012-2h14a2 2 0 012 2v7z"
            ></path>
          </svg>
          <span class="text-sm font-medium">{{ item.comments }}</span>
        </button>

        <!-- Shares -->
        <button
          class="flex items-center space-x-1 text-gray-500 hover:text-green-500 transition-colors"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"
            ></path>
          </svg>
          <span class="text-sm font-medium">{{ item.shares }}</span>
        </button>
      </div>

      <!-- Save Button -->
      <button class="text-gray-500 hover:text-yellow-500 transition-colors">
        <svg
          class="w-5 h-5"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"
          ></path>
        </svg>
      </button>
    </div>
  </div>
</article>
{% endif %} {% endfor %}
